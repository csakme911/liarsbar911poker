<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liars Poker: Revolver Roulette</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background: linear-gradient(to bottom right, #333333, #1a1a1a); /* Alap háttér */
            color: #eee;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            overflow: hidden;
        }

        body.red-screen { /* Ez az osztály teszi pirossá a hátteret */
            background-color: #e74c3c; /* Élénk piros */
            transition: background-color 0.1s ease-in; /* Gyors átmenet pirosra */
        }
        body.gold-screen { /* ÚJ: Arany képernyő a győzelemhez */
            background-color: #FFD700; /* Arany szín */
            transition: background-color 0.5s ease-in-out; /* Simább átmenet */
        }

        h1 {
            font-family: 'Press Start 2P', cursive;
            font-size: 1.8em;
            margin-bottom: 30px;
            text-align: center;
            color: #FFD700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            transition: opacity 0.5s ease; /* Átmenet a címnél, ha elrejtjük */
        }

        #info-button {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #3498DB;
            color: white;
            font-family: 'Press Start 2P', cursive;
            font-size: 1.5em;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 2px solid #2980B9;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
            transition: background-color 0.2s, transform 0.2s, opacity 0.5s ease; /* Átmenet a gombon, ha elrejtjük */
            z-index: 1001; /* Hogy a piros villanás alatt is látszódjon */
        }

        #info-button:hover {
            background-color: #2980B9;
            transform: scale(1.05);
        }

        /* ÚJ: Nyelválasztó gomb stílusa */
        #language-toggle {
            position: absolute;
            top: 20px;
            right: 20px; /* Jobb felső sarok */
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #f39c12; /* Narancssárga */
            color: white;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.9em; /* Kisebb betűméret, hogy elférjen HU/EN */
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 2px solid #e67e22;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
            transition: background-color 0.2s, transform 0.2s, opacity 0.5s ease;
            z-index: 1001;
        }

        #language-toggle:hover {
            background-color: #e67e22;
            transform: scale(1.05);
        }

        #info-modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: #2c3e50;
            margin: auto;
            padding: 25px;
            border: 3px solid #FFD700;
            border-radius: 10px;
            width: 80%;
            max-width: 600px;
            color: #eee;
            position: relative;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            max-height: 90vh;
            overflow-y: auto;
        }

        .close-button {
            color: #aaa;
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close-button:hover,
        .close-button:focus {
            color: #FFD700;
            text-decoration: none;
            cursor: pointer;
        }

        .modal-content h2, .modal-content h3 {
            color: #FFD700;
            margin-top: 20px;
            margin-bottom: 10px;
            font-family: 'Press Start 2P', cursive;
            font-size: 1.2em;
        }

        .modal-content ul {
            list-style-type: disc;
            margin-left: 20px;
            margin-bottom: 15px;
        }

        .modal-content ol {
            list-style-type: decimal;
            margin-left: 20px;
            margin-bottom: 15px;
        }

        .modal-content p {
            margin-bottom: 10px;
        }

        #poker-rank-image {
            max-width: 100%;
            height: auto;
            margin-top: 20px;
            border: 2px solid #FFD700;
            border-radius: 5px;
        }

        #game-info, .bet-controls, .button-container {
            transition: opacity 0.5s ease; /* Átmenet az elemek elrejtésére/megjelenítésére */
        }

        #game-info {
            font-size: 1.2em;
            margin-bottom: 25px;
            color: #FFD700;
            font-weight: bold;
            text-align: center;
            min-height: 50px;
        }

        #current-bet-info {
            font-size: 1.1em;
            margin-bottom: 15px;
            color: #eee;
        }

        .bet-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .bet-controls label {
            white-space: nowrap;
            font-weight: bold;
        }

        .bet-controls select {
            padding: 8px 15px;
            font-size: 1em;
            border-radius: 5px;
            border: 1px solid #FFD700;
            background-color: #2c3e50;
            color: #eee;
            cursor: pointer;
            outline: none;
        }
        .bet-controls select:focus {
            border-color: #E74C3C;
        }

        .button-container {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 40px;
        }

        button {
            padding: 18px 35px;
            font-size: 20px;
            cursor: pointer;
            background-color: #E74C3C;
            color: white;
            border: none;
            border-radius: 10px;
            transition: background-color 0.3s ease, transform 0.1s ease, box-shadow 0.3s ease;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
            outline: none;
            text-transform: uppercase;
        }

        #addBulletBtn {
            background-color: #28a745; /* Zöld */
        }
        #allInBtn {
            background-color: #dc3545; /* Sötét piros az All-in-hez */
        }
        #foldBtn {
            background-color: #ffc107; /* Sárga */
            color: #333;
        }
        #startGameBtn {
            background-color: #007bff; /* Kék */
        }
        #newRoundBtn {
            background-color: #17a2b8; /* Cián kék */
        }
        #winBtn {
            background-color: #4CAF50; /* Zöldebb */
            color: white;
        }

        button:hover:not(:disabled) {
            background-color: #C0392B;
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
        }
        #addBulletBtn:hover:not(:disabled) { background-color: #218838; }
        #allInBtn:hover:not(:disabled) { background-color: #c82333; }
        #foldBtn:hover:not(:disabled) { background-color: #e0a800; }
        #startGameBtn:hover:not(:disabled) { background-color: #0056b3; }
        #newRoundBtn:hover:not(:disabled) { background-color: #138496; }
        #winBtn:hover:not(:disabled) { background-color: #45a049; }

        button:active:not(:disabled) {
            background-color: #A93226;
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        #addBulletBtn:active:not(:disabled) { background-color: #1e7e34; }
        #allInBtn:active:not(:disabled) { background-color: #bd2130; }
        #foldBtn:active:not(:disabled) { background-color: #d39e00; }
        #startGameBtn:active:not(:disabled) { background-color: #004085; }
        #newRoundBtn:active:not(:disabled) { background-color: #117a8b; }
        #winBtn:active:not(:disabled) { background-color: #3e8e41; }

        button:disabled {
            background-color: #7f8c8d;
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }

        #revolver-display {
            width: 200px;
            height: 200px;
            border: 4px solid #FFD700;
            border-radius: 50%;
            display: flex; /* Mindig flex, hogy a gyermek elemek jól rendeződjenek */
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background-color: #2c3e50;
            overflow: hidden;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
            position: relative;
            margin-top: 20px;
            opacity: 0; /* Alapból átlátszatlan */
            pointer-events: none; /* Ne lehessen kattintani rá, ha rejtett */
            transition: opacity 0.5s ease; /* Átmenet az elrejtésére/megjelenítésére */
            z-index: 999; /* Hogy a piros villanás alatt is látszódjon */
        }

        #chamber-display {
            font-family: 'Press Start 2P', cursive;
            font-size: 4em;
            color: #eee;
            text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%; /* Kitölti a revolver-displayt */
            height: 100%; /* Kitölti a revolver-displayt */
            line-height: 1; /* Elveszi a betű alapértelmezett sorközét, ami eltolhatja */
            z-index: 2;
        }
        
        .shake {
            animation: shake 0.5s ease-out;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-10px); }
            40%, 80% { transform: translateX(10px); }
        }

        #message-display {
            font-size: 1.5em;
            font-weight: bold;
            margin-top: 20px;
            text-align: center;
            color: #eee;
            min-height: 1.5em;
            transition: opacity 0.5s ease; /* Átmenet az elrejtésére/megjelenítésére */
            z-index: 1002; /* Message display legyen az első piros képernyőn */
        }
        
        /* ÚJ stílus az elemek elrejtésére, amikor a piros képernyő aktív */
        .hidden-during-red {
            opacity: 0;
            pointer-events: none; /* Letiltja a kattintást az elemre, ha rejtett */
        }
        /* Revolver display láthatóság vezérlése JS-ből, opacity-vel */
        .revolver-visible {
            opacity: 1 !important; /* Fontos, hogy felülírja az alap opacity: 0-t */
            pointer-events: auto !important;
        }

        /* ÚJ: Egy overlay, ami fedi az egész képernyőt a piros villanáskor */
        #red-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #e74c3c; /* Élénk piros */
            opacity: 0; /* Alapból átlátszatlan */
            pointer-events: none; /* Ne akadályozza a kattintást, ha rejtett */
            z-index: 998; /* A revolver kijelzője és az infó gomb fölé, de a message alá */
            transition: opacity 0.1s ease-in;
        }
        #red-overlay.active {
            opacity: 1;
        }
        /* ÚJ: Arany overlay a győzelemhez */
        #gold-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #FFD700; /* Arany szín */
            opacity: 0; /* Alapból átlátszatlan */
            pointer-events: none; /* Ne akadályozza a kattintást, ha rejtett */
            z-index: 998; /* A revolver kijelzője és az infó gomb fölé, de a message alá */
            transition: opacity 0.5s ease-in-out; /* Simább átmenet */
        }
        #gold-overlay.active {
            opacity: 1;
        }
    </style>
</head>
<body>
    <h1 id="main-title">Liars Poker: Revolver Rulett</h1>

    <div id="info-button">i</div>
    <div id="language-toggle">EN</div> <div id="info-modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2>Liars Poker - A Lőszer Tét Szabályai</h2>
            <p>Üdvözöllek a Liars Poker halálos revolver rulettjében! Ebben a játékban a bátorságod és a szerencséd dönt.</p>

            <h3>A Játék Menete:</h3>
            <ol>
                <li>**Játék indítása:** A kör kezdetén a revolver automatikusan kap **1 golyót**. Ez a minimális tét.</li>
                <li>
                    <h3>Tétrakás:</h3>
                    <ul>
                        <li>**"Tét hozzáadása" gomb:** Választhatsz, hogy mennyi extra golyót (1-7) teszel be a revolverbe az aktuális körben. Ez növeli a revolverben lévő golyók számát, és így a találat esélyét is.</li>
                        <li>**"All-in" gomb:** Ha készen állsz a végső próbára, kattints az "All-in" gombra. Ezzel azonnal **8 golyót** teszel a revolverbe.</li>
                    </ul>
                </li>
                <li>
                    <h3>A döntés gombok:</h3>
                    <ul>
                        <li>**"Fold (Lövéspróba)" gomb:** Ezt akkor nyomd meg, ha úgy döntöttél, hogy kockáztatsz, és lövéspróbát hajtasz végre az **aktuálisan betett golyókkal**. Ha elsül, vesztettél. Ha "Katt", túlélted a kört!</li>
                        <li>**"[Win]" gomb:** Ezt akkor nyomd meg, ha **az asztali póker játékban nyertél** (és így nem kell lövéspróbát tenned). Ez új kört indít, és arany színű jutalmazásban részesülsz!</li>
                    </ul>
                </li>
                <li>**Kiesés:** Ha a revolver elsül, a játék véget ér, és a "Játék indítása" gombbal tudod újra kezdeni.</li>
                <li>**A cél:** Túlélni a lövéspróbákat, miközben licitálsz az asztali pókerben, és megpróbálod elkerülni a "Fold"-ot, ha nyertél!</li>
            </ol>
            
            <h3>Póker Kéz Erősség (Általános Sorrend):</h3>
            <p>(Megjegyzés: Az asztali játékod szabályai döntőek, ez csak egy általános segédlet.)</p>
            <img id="poker-rank-image" src="poker_ranks.png" alt="Póker Kéz Erősségi Sorrend">
        </div>
    </div>

    <div id="game-elements-container">
        <div id="game-info">
            <p><span id="bullets-in-chamber-text">Golyók a revolverben: </span><span id="bullets-in-chamber">0</span>/8</p>
            <p><span id="current-bet-text">Aktuális tét: </span><span id="current-bet">0</span> golyó</p>
        </div>

        <div class="bet-controls">
            <label for="extraBulletAmount" id="extra-bullets-label">Extra golyók:</label>
            <select id="extraBulletAmount">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
            </select>
        </div>

        <div class="button-container">
            <button id="startGameBtn">Játék indítása</button>
            <button id="addBulletBtn" style="display: none;">Tét hozzáadása</button>
            <button id="allInBtn" style="display: none;">All-in (8 golyóval)</button>
            <button id="foldBtn" style="display: none;">Fold (Lövéspróba)</button>
            <button id="winBtn" style="display: none;">Win</button>
        </div>
        
    </div>

    <div id="revolver-display">
        <span id="chamber-display">?</span>
    </div>

    <div id="message-display">Készen állsz egy halálos játszmára?</div>

    <div id="red-overlay"></div>
    <div id="gold-overlay"></div>


    <audio id="trigger-pull-sound" src="trigger_pull.mp3" preload="auto"></audio>
    <audio id="bullet-sound" src="bullet_shot.mp3" preload="auto"></audio>
    <audio id="click-empty-sound" src="click_empty.mp3" preload="auto"></audio>
    <audio id="game-music" src="game_music.mp3" preload="auto" loop></audio>

    <script>
        // DOM elemek
        const infoButton = document.getElementById('info-button');
        const infoModal = document.getElementById('info-modal');
        const closeButton = document.querySelector('.close-button');
        const bulletsInChamberSpan = document.getElementById('bullets-in-chamber');
        const currentBetSpan = document.getElementById('current-bet');
        const extraBulletAmountSelect = document.getElementById('extraBulletAmount');
        const startGameBtn = document.getElementById('startGameBtn');
        const addBulletBtn = document.getElementById('addBulletBtn');
        const allInBtn = document.getElementById('allInBtn');
        const foldBtn = document.getElementById('foldBtn');
        const winBtn = document.getElementById('winBtn'); 
        const revolverDisplay = document.getElementById('revolver-display');
        const chamberDisplay = document.getElementById('chamber-display');
        const messageDisplay = document.getElementById('message-display');
        const body = document.body;

        const mainTitle = document.getElementById('main-title');
        const gameElementsContainer = document.getElementById('game-elements-container');
        const redOverlay = document.getElementById('red-overlay');
        const goldOverlay = document.getElementById('gold-overlay');

        // Nyelvi elemek
        const languageToggleBtn = document.getElementById('language-toggle');
        let currentLanguage = 'hu'; // Kezdeti nyelv: magyar

        const bulletsInChamberTextSpan = document.getElementById('bullets-in-chamber-text');
        const currentBetTextSpan = document.getElementById('current-bet-text');
        const extraBulletsLabel = document.getElementById('extra-bullets-label');


        // Hangfájlok
        const triggerPullSound = document.getElementById('trigger-pull-sound');
        const bulletSound = document.getElementById('bullet-sound');
        const clickEmptySound = document.getElementById('click-empty-sound');
        const gameMusic = document.getElementById('game-music');

        // Játék állapot változók
        let bulletsInChamber = 0; 
        let currentBet = 0;      
        let gameActive = false;
        const MAX_CHAMBERS = 8; 

        // Szövegek gyűjteménye nyelvenként
        const texts = {
            hu: {
                mainTitle: "Liars Poker: Revolver Rulett",
                infoButton: "i",
                infoModalTitle: "Liars Poker - A Lőszer Tét Szabályai",
                infoModalWelcome: "Üdvözöllek a Liars Poker halálos revolver rulettjében! Ebben a játékban a bátorságod és a szerencséd dönt.",
                infoModalHowToPlayTitle: "A Játék Menete:",
                infoModalStep1: "**Játék indítása:** A kör kezdetén a revolver automatikusan kap **1 golyót**. Ez a minimális tét.",
                infoModalStep2Title: "Tétrakás:",
                infoModalStep2Bullet1: "**\"Tét hozzáadása\" gomb:** Választhatsz, hogy mennyi extra golyót (1-7) teszel be a revolverbe az aktuális körben. Ez növeli a revolverben lévő golyók számát, és így a találat esélyét is.",
                infoModalStep2Bullet2: "**\"All-in\" gomb:** Ha készen állsz a végső próbára, kattints az \"All-in\" gombra. Ezzel azonnal **8 golyót** teszel a revolverbe.",
                infoModalStep3Title: "A döntés gombok:",
                infoModalStep3Bullet1: "**\"Fold (Lövéspróba)\" gomb:** Ezt akkor nyomd meg, ha úgy döntöttél, hogy kockáztatsz, és lövéspróbát hajtasz végre az **aktuálisan betett golyókkal**. Ha elsül, vesztettél. Ha \"Katt\", túlélted a kört!",
                infoModalStep3Bullet2: "**\"Win\" gomb:** Ezt akkor nyomd meg, ha **az asztali póker játékban nyertél** (és így nem kell lövéspróbát tenned). Ez új kört indít, és arany színű jutalmazásban részesülsz!",
                infoModalStep4: "**Kiesés:** Ha a revolver elsül, a játék véget ér, és a \"Játék indítása\" gombbal tudod újra kezdeni.",
                infoModalStep5: "**A cél:** Túlélni a lövéspróbákat, miközben licitálsz az asztali pókerben, és megpróbálod elkerülni a \"Fold\"-ot, ha nyertél!",
                infoModalPokerRanksTitle: "Póker Kéz Erősség (Általános Sorrend):",
                infoModalPokerRanksText: "(Megjegyzés: Az asztali játékod szabályai döntőek, ez csak egy általános segédlet.)",
                bulletsInChamber: "Golyók a revolverben: ",
                currentBet: "Aktuális tét: ",
                extraBulletsLabel: "Extra golyók:",
                startGameBtn: "Játék indítása",
                addBulletBtn: "Tét hozzáadása",
                allInBtn: "All-in (8 golyóval)",
                foldBtn: "Fold (Lövéspróba)",
                winBtn: "Win",
                messageReady: "Készen állsz egy halálos játszmára?",
                messageRoundStart: "A kör 1 golyóval indult. Növeld a tétet, vagy nyomd meg a Fold (Lövéspróba)-t a lövéspróbához, vagy a Win-t, ha nyertél a pókerben!",
                messageInvalidBullets: "Kérlek válassz érvényes számú extra golyót!",
                messageTooManyBullets: (remaining) => `Nem tehetsz be ennyi golyót! Maximum ${remaining} golyót rakhatsz még be.`,
                messageBetIncreased: (bet) => `Téted növelve: ${bet} golyó. Mi a következő lépés?`,
                messageMaxBet: "Elérted a maximum tétet! Most már csak a Fold (Lövéspróba) vagy a Win maradt!",
                messageAllIn: "ALL-IN! Maximális téttel licitálsz! Most már csak a Fold (Lövéspróba) vagy a Win maradt!",
                messageFoldAttempt: (bet) => `FOLD! Lövéspróba az aktuális ${bet} golyóval!`,
                messageWin: "GYŐZELEM! Sikeresen nyerted a kört!",
                messageBoom: "BUMM! Kiestél!",
                messageGameOver: "Játék vége. Kezdj egy új játszmát!",
                messageClick: "KATT! Túlélted!",
                messageSurvived: "Katt! Túlélted! Indíts új játékot."
            },
            en: {
                mainTitle: "Liars Poker: Revolver Roulette",
                infoButton: "i",
                infoModalTitle: "Liars Poker - Bullet Bet Rules",
                infoModalWelcome: "Welcome to Liars Poker's deadly revolver roulette! In this game, your courage and luck will decide.",
                infoModalHowToPlayTitle: "How to Play:",
                infoModalStep1: "**Start Game:** At the beginning of the round, the revolver automatically gets **1 bullet**. This is the minimum bet.",
                infoModalStep2Title: "Placing Bets:",
                infoModalStep2Bullet1: "**\"Add Bet\" button:** You can choose how many extra bullets (1-7) you put into the revolver in the current round. This increases the number of bullets in the revolver, and thus the chance of a hit.",
                infoModalStep2Bullet2: "**\"All-in\" button:** If you're ready for the ultimate challenge, click the \"All-in\" button. This immediately puts **8 bullets** into the revolver.",
                infoModalStep3Title: "Decision Buttons:",
                infoModalStep3Bullet1: "**\"Fold (Shot Attempt)\" button:** Press this if you've decided to take a risk and perform a shot attempt with the **currently loaded bullets**. If it fires, you lose. If it \"Clicks\", you survived the round!",
                infoModalStep3Bullet2: "**\"Win\" button:** Press this if you **won the table poker game** (and thus don't have to make a shot attempt). This starts a new round and rewards you with a golden screen!",
                infoModalStep4: "**Elimination:** If the revolver fires, the game ends, and you can restart it with the \"Start Game\" button.",
                infoModalStep5: "**The Goal:** Survive the shot attempts while betting in table poker, and try to avoid \"Folding\" if you've won!",
                infoModalPokerRanksTitle: "Poker Hand Strength (General Order):",
                infoModalPokerRanksText: "(Note: Your table game rules are decisive; this is just a general guide.)",
                bulletsInChamber: "Bullets in chamber: ",
                currentBet: "Current bet: ",
                extraBulletsLabel: "Extra Bullets:",
                startGameBtn: "Start Game",
                addBulletBtn: "Add Bet",
                allInBtn: "All-in (8 bullets)",
                foldBtn: "Fold (Shot Attempt)",
                winBtn: "Win",
                messageReady: "Are you ready for a deadly game?",
                messageRoundStart: "Round started with 1 bullet. Increase your bet, or press Fold (Shot Attempt) for a shot, or Win if you won at poker!",
                messageInvalidBullets: "Please select a valid number of extra bullets!",
                messageTooManyBullets: (remaining) => `You cannot add that many bullets! You can add a maximum of ${remaining} more bullets.`,
                messageBetIncreased: (bet) => `Your bet increased: ${bet} bullets. What's next?`,
                messageMaxBet: "You reached maximum bet! Now only Fold (Shot Attempt) or Win remains!",
                messageAllIn: "ALL-IN! Betting with maximum bullets! Now only Fold (Shot Attempt) or Win remains!",
                messageFoldAttempt: (bet) => `FOLD! Shot attempt with current ${bet} bullets!`,
                messageWin: "VICTORY! You successfully won the round!",
                messageBoom: "BOOM! You're out!",
                messageGameOver: "Game Over. Start a new game!",
                messageClick: "CLICK! You survived!",
                messageSurvived: "Click! You survived! Start a new game."
            }
        };

        // Függvény a szövegek frissítéséhez
        function updateTexts() {
            const lang = currentLanguage;

            mainTitle.textContent = texts[lang].mainTitle;
            bulletsInChamberTextSpan.textContent = texts[lang].bulletsInChamber;
            currentBetTextSpan.textContent = texts[lang].currentBet;
            extraBulletsLabel.textContent = texts[lang].extraBulletsLabel;
            startGameBtn.textContent = texts[lang].startGameBtn;
            addBulletBtn.textContent = texts[lang].addBulletBtn;
            allInBtn.textContent = texts[lang].allInBtn;
            foldBtn.textContent = texts[lang].foldBtn;
            winBtn.textContent = texts[lang].winBtn;
            messageDisplay.textContent = texts[lang].messageReady;

            // Modal tartalmának frissítése
            const modalContent = document.querySelector('.modal-content');
            modalContent.querySelector('h2').textContent = texts[lang].infoModalTitle;
            
            // Az első p elem frissítése
            const firstPInModal = modalContent.querySelector('.modal-content > p');
            if (firstPInModal) firstPInModal.textContent = texts[lang].infoModalWelcome;

            const olItems = modalContent.querySelectorAll('ol > li');
            if (olItems[0]) olItems[0].innerHTML = texts[lang].infoModalStep1;
            
            // A nested UL elemek elérése az OL-en belül
            const olItem2Bullets = olItems[1] ? olItems[1].querySelectorAll('ul > li') : null;
            if (olItem2Bullets && olItem2Bullets[0]) olItem2Bullets[0].innerHTML = texts[lang].infoModalStep2Bullet1;
            if (olItem2Bullets && olItem2Bullets[1]) olItem2Bullets[1].innerHTML = texts[lang].infoModalStep2Bullet2;

            const olItem3Bullets = olItems[2] ? olItems[2].querySelectorAll('ul > li') : null;
            if (olItem3Bullets && olItem3Bullets[0]) olItem3Bullets[0].innerHTML = texts[lang].infoModalStep3Bullet1;
            if (olItem3Bullets && olItem3Bullets[1]) olItem3Bullets[1].innerHTML = texts[lang].infoModalStep3Bullet2;
            
            if (olItems[3]) olItems[3].innerHTML = texts[lang].infoModalStep4;
            if (olItems[4]) olItems[4].innerHTML = texts[lang].infoModalStep5;

            // Címek frissítése
            const modalHeadings = modalContent.querySelectorAll('h3');
            if (modalHeadings[0]) modalHeadings[0].textContent = texts[lang].infoModalHowToPlayTitle;
            if (modalHeadings[1]) modalHeadings[1].textContent = texts[lang].infoModalStep2Title;
            if (modalHeadings[2]) modalHeadings[2].textContent = texts[lang].infoModalStep3Title;
            if (modalHeadings[3]) modalHeadings[3].textContent = texts[lang].infoModalPokerRanksTitle;

            // Utolsó p elem a modalban
            const lastPInModal = modalContent.querySelector('.modal-content p:last-of-type');
            if (lastPInModal) lastPInModal.textContent = texts[lang].infoModalPokerRanksText;

            // Nyelv gomb szövege
            languageToggleBtn.textContent = (lang === 'hu' ? 'EN' : 'HU');
        }

        // --- Infó modal kezelése ---
        infoButton.addEventListener('click', () => {
            infoModal.style.display = 'flex';
        });

        closeButton.addEventListener('click', () => {
            infoModal.style.display = 'none';
        });

        window.addEventListener('click', (event) => {
            if (event.target == infoModal) {
                infoModal.style.display = 'none';
            }
        });
        // --- Infó modal vége ---

        // Eseménykezelő a nyelváltó gombhoz
        languageToggleBtn.addEventListener('click', () => {
            currentLanguage = (currentLanguage === 'hu' ? 'en' : 'hu');
            updateTexts();
            updateGameInfo(); // Frissíti a golyó infókat is
            // Ha játék közben váltunk nyelvet, az üzenetet visszaállítjuk az alapértelmezettre,
            // mivel az aktuális játékállapotot leíró üzenetek dinamikusak.
            messageDisplay.textContent = texts[currentLanguage].messageReady;
        });

        // --- Játék indítása és kör kezelése ---
        startGameBtn.addEventListener('click', startGame);
        addBulletBtn.addEventListener('click', handleAddBullet);
        allInBtn.addEventListener('click', handleAllIn);
        foldBtn.addEventListener('click', handleFold);
        winBtn.addEventListener('click', handleWin);

        function startGame() {
            gameActive = true;
            bulletsInChamber = 1; 
            currentBet = 1;      
            
            updateGameInfo();
            messageDisplay.textContent = texts[currentLanguage].messageRoundStart; 
            
            startGameBtn.style.display = 'none';
            addBulletBtn.style.display = 'block';
            allInBtn.style.display = 'block';
            foldBtn.style.display = 'block';
            winBtn.style.display = 'block';

            addBulletBtn.disabled = false;
            allInBtn.disabled = false;
            foldBtn.disabled = false;
            winBtn.disabled = false;  
            extraBulletAmountSelect.disabled = false; 
            
            revolverDisplay.classList.remove('revolver-visible'); 
            chamberDisplay.textContent = '?'; 

            body.classList.remove('red-screen');
            body.classList.remove('gold-screen'); 
            redOverlay.classList.remove('active'); 
            goldOverlay.classList.remove('active'); 
            mainTitle.classList.remove('hidden-during-red');
            infoButton.classList.remove('hidden-during-red');
            gameElementsContainer.classList.remove('hidden-during-red');

            gameMusic.volume = 0.3; 
            gameMusic.play().catch(e => console.error("Játékzene lejátszása sikertelen:", e));

            extraBulletAmountSelect.value = 1;
            checkAllInButtonState(); 
        }

        function updateGameInfo() {
            bulletsInChamberSpan.textContent = bulletsInChamber;
            currentBetSpan.textContent = currentBet;
            
            bulletsInChamberTextSpan.textContent = texts[currentLanguage].bulletsInChamber;
            currentBetTextSpan.textContent = texts[currentLanguage].currentBet;
            extraBulletsLabel.textContent = texts[currentLanguage].extraBulletsLabel;

            const maxAddableBullets = MAX_CHAMBERS - currentBet; 
            extraBulletAmountSelect.innerHTML = ''; 
            for (let i = 1; i <= maxAddableBullets; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = i;
                extraBulletAmountSelect.appendChild(option);
            }

            if (maxAddableBullets === 0) { 
                extraBulletAmountSelect.disabled = true;
                addBulletBtn.disabled = true;
                allInBtn.disabled = true; 
            } else {
                extraBulletAmountSelect.disabled = false;
                addBulletBtn.disabled = false;
                allInBtn.disabled = false;
            }
            foldBtn.disabled = false; 
            winBtn.disabled = false; 
        }

        function checkAllInButtonState() {
            if (currentBet < MAX_CHAMBERS) {
                allInBtn.disabled = false;
            } else {
                allInBtn.disabled = true; 
            }
        }

        function handleAddBullet() {
            if (!gameActive) return;

            const extraBullets = parseInt(extraBulletAmountSelect.value);
            
            if (isNaN(extraBullets) || extraBullets <= 0) {
                messageDisplay.textContent = texts[currentLanguage].messageInvalidBullets;
                return;
            }

            const newTotalBullets = currentBet + extraBullets;

            if (newTotalBullets > MAX_CHAMBERS) {
                messageDisplay.textContent = texts[currentLanguage].messageTooManyBullets(MAX_CHAMBERS - currentBet);
                return;
            }

            currentBet = newTotalBullets;
            bulletsInChamber = newTotalBullets; 
            updateGameInfo();

            messageDisplay.textContent = texts[currentLanguage].messageBetIncreased(currentBet);
            
            if (currentBet === MAX_CHAMBERS) { 
                addBulletBtn.disabled = true;
                allInBtn.disabled = true;
                extraBulletAmountSelect.disabled = true;
                messageDisplay.textContent = texts[currentLanguage].messageMaxBet;
            } else {
                addBulletBtn.disabled = false;
                allInBtn.disabled = false;
                extraBulletAmountSelect.disabled = false;
            }
            foldBtn.disabled = false;
            winBtn.disabled = false;
        }

        function handleAllIn() {
            if (!gameActive) return;

            currentBet = MAX_CHAMBERS; 
            bulletsInChamber = MAX_CHAMBERS;
            updateGameInfo();

            messageDisplay.textContent = texts[currentLanguage].messageAllIn;
            
            addBulletBtn.disabled = true;
            allInBtn.disabled = true;
            extraBulletAmountSelect.disabled = true;
            addBulletBtn.style.display = 'none'; 
            allInBtn.style.display = 'none';     

            foldBtn.disabled = false; 
            winBtn.disabled = false; 
            foldBtn.style.display = 'block';
            winBtn.style.display = 'block';
        }

        function handleFold() {
            if (!gameActive) return;

            messageDisplay.textContent = texts[currentLanguage].messageFoldAttempt(currentBet);
            
            addBulletBtn.disabled = true;
            allInBtn.disabled = true;
            foldBtn.disabled = true;
            winBtn.disabled = true;
            extraBulletAmountSelect.disabled = true;
            startGameBtn.disabled = true;

            addBulletBtn.style.display = 'none'; 
            allInBtn.style.display = 'none';     
            foldBtn.style.display = 'none';      
            winBtn.style.display = 'none';       

            setTimeout(() => performShotAttempt(), 2000);
        }

        function handleWin() { 
            if (!gameActive) return;

            messageDisplay.textContent = texts[currentLanguage].messageWin;
            
            addBulletBtn.disabled = true;
            allInBtn.disabled = true;
            foldBtn.disabled = true;
            winBtn.disabled = true;
            extraBulletAmountSelect.disabled = true;
            startGameBtn.disabled = true; 

            addBulletBtn.style.display = 'none'; 
            allInBtn.style.display = 'none';     
            foldBtn.style.display = 'none';      
            winBtn.style.display = 'none';       

            revolverDisplay.classList.remove('revolver-visible');
            chamberDisplay.textContent = '?'; 

            goldOverlay.classList.add('active'); 
            body.classList.remove('red-screen'); 

            setTimeout(() => {
                goldOverlay.classList.remove('active'); 
                startGame(); 
            }, 5000); 
        }

        function performShotAttempt() {
            revolverDisplay.classList.add('revolver-visible');
            revolverDisplay.classList.add('shake'); 
            chamberDisplay.textContent = '?'; 

            triggerPullSound.currentTime = 0;
            triggerPullSound.play().catch(e => console.error("Ravasz húzás hangja sikertelen:", e));

            setTimeout(() => {
                revolverDisplay.classList.remove('shake');
                
                const bulletHitPosition = Math.floor(Math.random() * MAX_CHAMBERS); 

                if (bulletHitPosition < bulletsInChamber) { 
                    messageDisplay.textContent = texts[currentLanguage].messageBoom;
                    chamberDisplay.textContent = 'X'; 
                    bulletSound.currentTime = 0;
                    bulletSound.play().catch(e => console.error("Lövés hangja sikertelen:", e));
                    
                    gameActive = false;
                    gameMusic.pause(); 

                    mainTitle.classList.add('hidden-during-red');
                    gameElementsContainer.classList.add('hidden-during-red');
                    
                    redOverlay.classList.add('active'); 
                    
                    setTimeout(() => {
                        redOverlay.classList.remove('active'); 
                        messageDisplay.textContent = texts[currentLanguage].messageGameOver;
                        startGameBtn.style.display = 'block'; 
                        startGameBtn.disabled = false; 

                        mainTitle.classList.remove('hidden-during-red');
                        gameElementsContainer.classList.remove('hidden-during-red');
                        
                        revolverDisplay.classList.remove('revolver-visible');
                        chamberDisplay.textContent = '?'; 

                    }, 5000); 
                    
                } else {
                    messageDisplay.textContent = texts[currentLanguage].messageClick;
                    chamberDisplay.textContent = 'O'; 
                    clickEmptySound.currentTime = 0;
                    clickEmptySound.play().catch(e => console.error("Üres kattanás hangja sikertelen:", e));
                    
                    setTimeout(() => {
                        messageDisplay.textContent = texts[currentLanguage].messageSurvived; 
                        
                        addBulletBtn.disabled = true;
                        allInBtn.disabled = true;
                        foldBtn.disabled = true;
                        winBtn.disabled = true;
                        extraBulletAmountSelect.disabled = true;

                        addBulletBtn.style.display = 'none';
                        allInBtn.style.display = 'none';
                        foldBtn.style.display = 'none';
                        winBtn.style.display = 'none';

                        startGameBtn.style.display = 'block'; 
                        startGameBtn.disabled = false;

                        revolverDisplay.classList.remove('revolver-visible'); 
                        chamberDisplay.textContent = '?'; 
                        
                    }, 1500); 
                }
            }, 1000); 
        }

        // --- Init: Játék kezdeti állapota ---
        updateTexts(); // Első hívás a kezdeti szövegek beállításához
        updateGameInfo(); // Frissíti a golyó infókat is
        addBulletBtn.style.display = 'none';
        allInBtn.style.display = 'none';
        foldBtn.style.display = 'none'; 
        winBtn.style.display = 'none'; 

        extraBulletAmountSelect.disabled = true;
        revolverDisplay.classList.remove('revolver-visible'); 
        chamberDisplay.textContent = '?'; 
        redOverlay.classList.remove('active'); 
        goldOverlay.classList.remove('active'); 
        
        startGameBtn.style.display = 'block';
        startGameBtn.disabled = false;
    </script>
</body>
</html>